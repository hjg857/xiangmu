<template>
  <div class="about-page">
    <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
    <header class="header">
      <div class="header-content">
        <div class="logo-section" @click="goHome">
          <el-icon :size="32" color="#409eff">
            <School />
          </el-icon>
          <h1 class="system-title">ä¸­å°å­¦æ ¡æ•°æ®æ–‡åŒ–æˆç†Ÿåº¦è¯„ä¼°ç›‘æµ‹ç³»ç»Ÿ</h1>
        </div>
        <nav class="nav-menu">
          <router-link to="/home" class="nav-item">é¦–é¡µ</router-link>
          <router-link to="/about" class="nav-item">å…³äºæˆ‘ä»¬</router-link>
          <router-link to="/culture" class="nav-item">æ•°æ®æ–‡åŒ–</router-link>
          <router-link to="/guide" class="nav-item">è¯„ä¼°è¯´æ˜</router-link>
          <router-link to="/news" class="nav-item">å®è·µåŠ¨æ€</router-link>
          <el-dropdown class="user-dropdown">
            <span class="user-info">
              <el-icon><User /></el-icon>
              <span>{{ schoolName || 'ç”¨æˆ·' }}</span>
            </span>
            <template #dropdown>
              <el-dropdown-menu>
                <el-dropdown-item @click="handleLogout">é€€å‡ºç™»å½•</el-dropdown-item>
              </el-dropdown-menu>
            </template>
          </el-dropdown>
        </nav>
      </div>
    </header>
    <!-- ä¸»ä½“å†…å®¹åŒº -->
<main class="main-content">
  <!-- âœ… å¡ç‰‡1ï¼šå…³äºæˆ‘ä»¬ -->
  <div class="content-card">
    <h2 class="page-title">å…³äºæˆ‘ä»¬</h2>
    <div class="title-underline"></div>

    <div class="about-content">
      <!-- å·¦ä¾§æ–‡å­—å†…å®¹ -->
      <div class="text-section">
        <p class="content-text">
          æœ¬ç³»ç»Ÿç”±æ±Ÿè‹å¸ˆèŒƒå¤§å­¦æ¨ç°æ°‘æ•™æˆé¢†è¡”çš„æ•™è‚²ä¿¡æ¯åŒ–ç ”ç©¶å›¢é˜Ÿæ‰“é€ ï¼Œåœ¨æ•°å­—åŒ–æµªæ½®å¸­å·æ•™è‚²é¢†åŸŸçš„èƒŒæ™¯ä¸‹ï¼Œæ•°æ®æˆä¸ºæ¨åŠ¨å…¨çƒæ•™è‚²å˜é©çš„é‡è¦åŠ›é‡ã€‚ç„¶è€Œï¼Œä¸­å°å­¦åœ¨æ•°æ®æ–‡åŒ–å»ºè®¾æ–¹é¢é¢ä¸´è¯¸å¤šæŒ‘æˆ˜ï¼Œå¦‚æ•°æ®æ„è¯†æ·¡è–„ï¼Œæ•°æ®åº”ç”¨èƒ½åŠ›ä¸è¶³ã€æ•°æ®ç®¡ç†æœºåˆ¶ä¸å®Œå–„ç­‰ã€‚ä¸ºåŠ©åŠ›ä¸­å°å­¦çªç ´ç“¶é¢ˆï¼Œæå‡æ•°æ®æ–‡åŒ–æˆç†Ÿåº¦ï¼Œæ¨ç°æ°‘æ•™æˆå›¢é˜Ÿç»“åˆå¤šå¹´æ•™è‚²ä¿¡æ¯åŒ–ç ”ç©¶ä¸å®è·µç»éªŒï¼Œå¼€å‘äº†"ä¸­å°å­¦æ ¡æ•°æ®æ–‡åŒ–æˆç†Ÿåº¦è¯„ä¼°ç›‘æµ‹ç³»ç»Ÿ"ã€‚
        </p>

        <p class="content-text">
          è¯¥ç³»ç»Ÿæ—¨åœ¨ä¸ºä¸­å°å­¦æ ¡æä¾›ç§‘å­¦ã€å…¨é¢ã€ä¾¿æ·çš„æ•°æ®æ–‡åŒ–è¯„ä¼°å·¥å…·ï¼Œé€šè¿‡ç²¾å‡†çš„è¯„ä¼°æŒ‡æ ‡ä½“ç³»ï¼Œå¸®åŠ©å­¦æ ¡æ¸…æ™°äº†è§£è‡ªèº«æ•°æ®æ–‡åŒ–å»ºè®¾çš„ç°çŠ¶ä¸ä¸è¶³ï¼Œä»è€Œä¿ƒè¿›åˆ‡å®å¯è¡Œçš„å‘å±•ç­–ç•¥ï¼Œä»¥è¯„ä¿ƒé©±åŠ¨ä¸­å°å­¦æ•°æ®æ²»ç†æ°´å¹³æå‡ï¼Œä¸ºæ•°æ®æ–‡åŒ–å‘å±•æä¾›æœ‰åŠ›æ”¯æŒã€‚
        </p>

        <p class="content-text">
          æ•°æ®æ–‡åŒ–å»ºè®¾æ˜¯ä¸€ä¸ªæŒç»­æ¢ç´¢ä¸å®è·µçš„è¿‡ç¨‹ï¼Œæœ¬ç³»ç»Ÿæ—¨åœ¨æ¿€å‘ä¸­å°å­¦æ ¡å¯¹æ•°æ®æ–‡åŒ–çš„é‡è§†ï¼Œå¼•å¯¼å­¦æ ¡ç§¯ææ¢ç´¢æ•°æ®é©±åŠ¨å‹ç»„ç»‡çš„å»ºè®¾ï¼Œä¸ºåŸ¹å…»é€‚åº”æ•°å­—æ—¶ä»£éœ€æ±‚çš„åˆ›æ–°å‹äººæ‰å¥ å®šåŸºç¡€ã€‚
        </p>
      </div>

      <!-- å³ä¾§å›¾ç‰‡ -->
      <div class="image-section">
        <img src="@/assets/images/about_us.png" alt="å…³äºæˆ‘ä»¬" class="about-image" />
      </div>
    </div>
  </div>

  <!-- âœ… å¡ç‰‡2ï¼šè”ç³»æˆ‘ä»¬ -->
  <div class="content-card">
    <h2 class="page-title">è”ç³»æˆ‘ä»¬</h2>
    <div class="title-underline"></div>

    <section class="contact-section">
      <div class="contact-content">
        <!-- å·¦ä¾§è¯´æ˜ -->
        <div class="contact-left">
          <p class="contact-desc">
            æˆ‘ä»¬æœŸå¾…ä¸å„çº§æ•™è‚²è¡Œæ”¿éƒ¨é—¨ã€ä¸­å°å­¦ã€ç ”ç©¶æœºæ„å¼€å±•å¹¿æ³›åˆä½œï¼Œ
            å…±åŒæ¨è¿›ä¸­å°å­¦æ•°æ®æ–‡åŒ–å»ºè®¾ä¸è¯„ä¼°å·¥ä½œã€‚
          </p>

          <div class="contact-email">
            <el-icon><Message /></el-icon>
            2020250606@jsnu.edu.cn
          </div>
          <p class="contact-note">
            æˆ‘ä»¬å°†å°½å¿«ä¸æ‚¨å–å¾—è”ç³»ï¼Œå…±åŒæ¢è®¨åˆä½œå¯èƒ½ã€‚
          </p>

        </div>

        <!-- å³ä¾§è¡¨å• -->
        <!-- å³ä¾§è¡¨å• -->
<div class="contact-right">
<el-form :model="contactForm" class="form-style">
  <el-form-item label="è”ç³»äººå‘˜">
    <el-input v-model="contactForm.name" placeholder="æ‚¨çš„å§“å" />
  </el-form-item>

  <el-form-item label="è”ç³»ç”µè¯">
    <el-input v-model="contactForm.phone" placeholder="æ‚¨çš„æ‰‹æœºå·ç " />
  </el-form-item>

  <el-form-item label="è”ç³»é‚®ç®±">
    <el-input v-model="contactForm.email" placeholder="æ‚¨çš„é‚®ç®±åœ°å€" />
  </el-form-item>

  <el-form-item label="åˆä½œæ„å‘">
    <el-select v-model="contactForm.type" placeholder="è¯·é€‰æ‹©">
      <el-option label="å­¦æ ¡æ•´ä½“è¯„ä¼°" value="å­¦æ ¡æ•´ä½“è¯„ä¼°" />
      <el-option label="æ•°æ®æ–‡åŒ–å»ºè®¾" value="æ•°æ®æ–‡åŒ–å»ºè®¾" />
      <el-option label="ç ”ç©¶åˆä½œ" value="ç ”ç©¶åˆä½œ" />
      <el-option label="å…¶ä»–" value="å…¶ä»–" />
    </el-select>
  </el-form-item>

  <el-form-item label="ç•™è¨€å†…å®¹">
    <el-input v-model="contactForm.message" type="textarea" :rows="4" />
  </el-form-item>

  <el-button type="primary" class="submit-btn" :loading="submitLoading"  @click="submitContact">
    æäº¤åˆä½œå’¨è¯¢ â†’
  </el-button>
</el-form>

</div>

      </div>
    </section>
  </div>
</main>

    
    <!-- åº•éƒ¨é¡µè„š -->
<footer class="footer">
  <div class="footer-bar">
    <div class="footer-inner">
      <!-- å·¦ä¾§ï¼šLOGO + æ–‡æ¡ˆ -->
      <div class="footer-left">
        <div class="footer-logo">
          <img src="@/assets/images/ila_logo.png" class="logo-img" alt="ILA" /> 
        </div>

        <div class="footer-text">
          <div class="line">
            Copyright Â© 2026 ç‰ˆæƒæ‰€æœ‰ï¼šæ™ºèƒ½å­¦ä¹ ä¸è¯„ä»·æ±Ÿè‹çœäº§ä¸šæŠ€æœ¯å·¥ç¨‹åŒ–ä¸­å¿ƒ
          </div>
          <div class="line">
            é‚®ç®±ï¼š2020250606@jsnu.edu.cnã€€
            åœ°å€ï¼šæ±Ÿè‹çœå¾å·å¸‚é“œå±±æ–°åŒºä¸Šæµ·è·¯101å·
          </div>
        </div>
      </div>

      <!-- å³ä¾§ï¼šäºŒç»´ç  -->
      <div class="footer-right">
        <img
          src="@/assets/images/Official_Account1.png"
          alt="å®˜æ–¹å…¬ä¼—å·"
          class="footer-qrcode"
        />
      </div>
    </div>
  </div>
</footer>

  </div>
</template>

<script setup>
import { ref, onMounted } from 'vue'
import { useRouter } from 'vue-router'
import { ElMessage } from 'element-plus'
import { School, User, Location, Message } from '@element-plus/icons-vue'
import { reactive } from 'vue'
import { apiPost } from '@/utils/api'

const contactForm = reactive({
  name: '',
  phone: '',
  email: '',
  type: '',
  message: ''
})

const submitLoading = ref(false)

const submitContact = async () => {
  // 1. åŸºç¡€æ ¡éªŒ
  if (!contactForm.name || !contactForm.phone || !contactForm.message) {
    ElMessage.warning('è¯·å¡«å†™è”ç³»äººã€è”ç³»ç”µè¯å’Œç•™è¨€å†…å®¹')
    return
  }

  submitLoading.value = true
  try {
    // 2. å‘èµ·è¯·æ±‚ (è·¯å¾„æ ¹æ®ä½ urls.pyçš„çˆ¶çº§å‰ç¼€è°ƒæ•´ï¼Œé€šå¸¸æ˜¯ /api/public/...)
    // è¿™é‡Œæˆ‘ä½¿ç”¨ä½ ä¹‹å‰èƒ½è·‘é€šçš„è·¯å¾„é£æ ¼
    const { res, data } = await apiPost('/api/contact-collaboration/', contactForm)
    
    if (res.ok || data.success) {
      ElMessage.success('æäº¤æˆåŠŸï¼æˆ‘ä»¬å·²æ”¶åˆ°æ‚¨çš„å’¨è¯¢ï¼Œä¼šå°½å¿«è”ç³»æ‚¨ã€‚')
      // 3. æˆåŠŸåé‡ç½®è¡¨å•
      Object.assign(contactForm, {
        name: '',
        phone: '',
        email: '',
        type: '',
        message: ''
      })
    } else {
      ElMessage.error(data.message || 'æäº¤å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•')
    }
  } catch (error) {
    console.error('æäº¤åˆä½œå’¨è¯¢å‡ºé”™:', error)
    ElMessage.error('ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥')
  } finally {
    submitLoading.value = false
  }
}






const router = useRouter()

const userInfo = ref({
  username: ''
})

const schoolName = ref('')

onMounted(() => {
  const storedUser = localStorage.getItem('user')
  if (storedUser) {
    userInfo.value = JSON.parse(storedUser)
    // è·å–å­¦æ ¡åç§°
    schoolName.value = userInfo.value.school_name || userInfo.value.username || 'ç”¨æˆ·'
  }
})

const goHome = () => {
  router.push('/home')
}

const handleLogout = () => {
  localStorage.removeItem('access_token')
  localStorage.removeItem('refresh_token')
  localStorage.removeItem('user')
  ElMessage.success('å·²é€€å‡ºç™»å½•')
  router.push('/login')
}
</script>

<style scoped>
.about-page {
  min-height: 100vh;
  display: flex;
  flex-direction: column;
  background-color: #f5f7fa;
}

/* é¡¶éƒ¨å¯¼èˆªæ  */
.header {
  background-color: #ffffff;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
  position: sticky;
  top: 0;
  z-index: 1000;
}

.header-content {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 40px;
  height: 70px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.logo-section {
  display: flex;
  align-items: center;
  gap: 12px;
  cursor: pointer;
}

.system-title {
  font-size: 20px;
  font-weight: 600;
  color: #303133;
  margin: 0;
}

.nav-menu {
  display: flex;
  align-items: center;
  gap: 32px;
}

.nav-item {
  color: #606266;
  text-decoration: none;
  font-size: 15px;
  transition: color 0.3s;
  cursor: pointer;
}

.nav-item:hover,
.nav-item.router-link-active {
  color: #409eff;
}

.user-dropdown {
  cursor: pointer;
}

.user-info {
  display: flex;
  align-items: center;
  gap: 6px;
  color: #606266;
  font-size: 14px;
}

.user-info:hover {
  color: #409eff;
}

/* ä¸»ä½“å†…å®¹åŒº */

.main-content {
  flex: 1;
  padding: 60px 40px 80px;
}

.content-container {
  max-width: 1400px;
  margin: 0 auto;
  background-color: #ffffff;
  border-radius: 12px;
  padding: 60px 80px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
}

.page-title {
  font-size: 36px;
  font-weight: 700;
  color: #303133;
  text-align: center;
  margin-bottom: 8px;
}

.title-underline {
  width: 60px;
  height: 4px;
  background-color: #ff9800;
  margin: 0 auto 50px;
  border-radius: 2px;
}

.about-content {
  display: flex;
  gap: 60px;
  align-items: flex-start;
}

.text-section {
  flex: 1;
  min-width: 0;
}

.section-subtitle {
  font-size: 20px;
  font-weight: 600;
  color: #303133;
  margin-bottom: 24px;
  line-height: 1.6;
}

.content-text {
  font-size: 15px;
  line-height: 2;
  color: #606266;
  margin-bottom: 20px;
  text-align: justify;
  text-indent: 2em;
}

.image-section {
  flex-shrink: 0;
  width: 400px;
}

.about-image {
  width: 100%;
  height: auto;
  border-radius: 12px;
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
}

.contact-section {
  margin-top: 80px;
}

.section-title {
  text-align: center;
  font-size: 32px;
  font-weight: 700;
  margin-bottom: 40px;
}

.contact-content {
  display: flex;
  gap: 60px;
}

.contact-left {
  flex: 1;
}

.contact-desc {
  font-size: 15px;
  line-height: 1.9;
  color: #606266;
  margin-bottom: 20px;
}

.contact-email {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 16px;
  background: #f5f7fa;
  border-radius: 6px;
  color: #409eff;
  font-size: 14px;
}

.contact-right {
  flex: 1;
  background: #ffffff;
  padding: 30px;
  border-radius: 10px;
  box-shadow: 0 2px 12px rgba(0,0,0,0.08);
}

.submit-btn {
  width: 100%;
  margin-top: 10px;
  height: 44px;
  font-size: 15px;
  font-weight: 600;
}

/* âœ… ä¸»ä½“ï¼šè®©ä¸¤ä¸ªå¡ç‰‡ä¹‹é—´å‡ºç°â€œç•™ç™½é—´éš”â€ */
.main-content {
  flex: 1;
  padding: 60px 40px 80px;
  background-color: #f5f7fa;
  display: flex;
  flex-direction: column;
  gap: 40px; /* ğŸ‘ˆ è¿™é‡Œå°±æ˜¯ä½ æˆªå›¾é‚£ç§é—´éš” */
}

/* âœ… ä¸¤å—å†…å®¹å„è‡ªä¸€ä¸ªç™½è‰²å¡ç‰‡ */
.content-card {
  max-width: 1400px;
  margin: 0 auto;
  background-color: #ffffff;
  border-radius: 12px;
  padding: 60px 80px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
}

/* è”ç³»æˆ‘ä»¬å¸ƒå±€ï¼ˆå¦‚æœä½ å·²æœ‰å°±ä¸ç”¨é‡å¤ï¼‰ */
.contact-content {
  display: flex;
  gap: 50px;
  align-items: flex-start;
}

.contact-left {
  flex: 1;
  min-width: 0;
}

.contact-right {
  width: 520px;
  flex-shrink: 0;
}

.contact-email {
  margin-top: 18px;
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 10px 14px;
  border-radius: 8px;
  background: #f5f7ff;
  color: #1d4ed8;
  font-weight: 500;
}

.submit-btn {
  width: 100%;
  height: 42px;
  font-weight: 600;
}

/* å“åº”å¼ï¼šå°å±æ”¹ä¸ºä¸Šä¸‹ç»“æ„ */
@media (max-width: 1024px) {
  .content-card {
    padding: 40px 24px;
  }

  .contact-content {
    flex-direction: column;
  }

  .contact-right {
    width: 100%;
  }
}

/* åº•éƒ¨é¡µè„š */
/* ===== Footerï¼ˆæ·±è‰²æ¡ï¼ŒæŒ‰æˆªå›¾ï¼‰===== */
.footer {
  margin-top: auto;
  width: 100%;
}

.footer-bar {
  background: #2f3d4a; /* æ·±è“ç°è‰²èƒŒæ™¯ */
  padding: 8px 0;    /* å¢åŠ ä¸Šä¸‹å†…è¾¹è·ï¼Œè®©æ¯”ä¾‹æ›´åè°ƒ */
}

.footer-inner {
  /* æ ¸å¿ƒï¼šå¿…é¡»ä¸ header-content çš„å®½åº¦å’Œå¯¹é½é€»è¾‘å®Œå…¨ä¸€è‡´ */
  max-width: 99%;
  margin: 0 auto;
  padding: 0 20px;    /* ä¸ header ä¿æŒä¸€è‡´çš„å·¦å³å†…è¾¹è· */
  
  display: flex;
  align-items: center;
  justify-content: space-between;
  box-sizing: border-box;
}

.footer-left {
  display: flex;
  align-items: center;
  gap: 10px;
  /* å½»åº•åˆ é™¤ä¹‹å‰çš„ margin-left: -200px */
}

.footer-logo .logo-img {
  height: 80px;
  width: auto;
  display: block;
}

.footer-text {
  color: rgba(255, 255, 255, 0.85);
  font-size: 14px;      /* æ ‡å‡†é¡µè„šå­—å· */
  line-height: 1.8;
  text-align: left;
}

.footer-text .line {
  white-space: nowrap; /* å¼ºåˆ¶ä¸æ¢è¡Œï¼Œä¿æŒæ•´é½ */
}

.footer-right {
  /* å½»åº•åˆ é™¤ä¹‹å‰çš„ margin-right: -200px */
  display: flex;
  align-items: center;
}

.qr-container {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
}

.footer-qrcode {
  width: 80px;
  height: 80px;
  border-radius: 4px;
  background: #ffffff;
  padding: 3px;
}

.qr-label {
  color: rgba(255, 255, 255, 0.6);
  font-size: 12px;
}

.contact-note {
  margin-top: 18px;          /* ä¸é‚®ç®±æ‹‰å¼€è·ç¦» */
  font-size: 13px;           /* æ¯”æ­£æ–‡å° */
  color: #9ca3af;            /* æµ…ç°è‰² */
  font-style: italic;        /* å¾®æ–œä½“ï¼Œå­¦æœ¯/è¯´æ˜æ„Ÿ */
  line-height: 1.6;
}


/* å°å±é€‚é…ï¼šå…è®¸æ¢è¡Œä¸”ä¸Šä¸‹å¸ƒå±€ */
@media (max-width: 900px) {
  .footer-inner {
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 0 20px;
  }

  .footer-left {
    flex-direction: column;
    gap: 10px;
  }

  .footer-text .line {
    white-space: normal; /* å°å±å…è®¸æ¢è¡Œ */
  }
}


.contact-section {
  flex: 1;
}

.contact-title {
  font-size: 16px;
  font-weight: 600;
  color: #303133;
  margin-bottom: 12px;
}

.contact-details {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.contact-details p {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: #606266;
  margin: 0;
}

.contact-details .el-icon {
  color: #409eff;
}

.qrcode-section {
  flex-shrink: 0;
}

.qrcode {
  width: 100px;
  height: 100px;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 1024px) {
  .about-content {
    flex-direction: column;
    gap: 40px;
  }

  .image-section {
    width: 100%;
    max-width: 500px;
    margin: 0 auto;
  }
}

@media (max-width: 768px) {
  .header-content {
    padding: 0 20px;
    height: auto;
    flex-direction: column;
    padding-top: 16px;
    padding-bottom: 16px;
  }

  .nav-menu {
    flex-wrap: wrap;
    gap: 16px;
    margin-top: 12px;
  }

  .system-title {
    font-size: 16px;
  }

  .content-container {
    padding: 40px 24px;
  }

  .page-title {
    font-size: 28px;
  }

  .section-subtitle {
    font-size: 18px;
  }

  .content-text {
    font-size: 14px;
  }

  .contact-details p {
    justify-content: center;
  }
}
</style>
